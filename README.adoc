= Robot Repo Bot (RSR)
:doctype: book
:icons: font
:source-highlighter: rouge
:toc: left
:toclevels: 3
:sectnums:
:author: Hyperpolymath
:revnumber: 2.1.0-spark
:revdate: 2025-12-18

[abstract]
.Rhodium Standard Compliance
The **Robot Repo Bot** is an autonomous infrastructure agent designed to enforce **Rhodium Standard (RSR)** compliance across distributed repositories. Unlike passive linters, the Robot actively "heals" the filesystem using SaltStack, ensured by a formally verified **Ada/SPARK** control plane.

---

== 1. Architecture

The Robot operates on a **Hexagonal Architecture**, separating the Safety Logic from the Execution Engine.

[plantuml, robot_arch, png]
....
@startuml
skinparam monochrome true
package "Control Plane (The Brain)" {
  [Ada/SPARK Coordinator] as Ada
  note right: Formally Verified\nState Safety
}
package "Execution Plane (The Muscle)" {
  [Python Engine] as Python
  [SaltStack Local] as Salt
}
database "Filesystem" as FS

User -> Ada : "Repair Ruthlessly"
Ada -> Ada : Check Safety Contract\n(Is_Safe?)
Ada -> Python : Dispatch Valid Command
Python -> Salt : Apply State
Salt -> FS : Enforce Permissions/Structure
@enduml
....

* **The Coordinator (Ada/SPARK):** A TUI that mathematically prevents unsafe state transitions (e.g., destructive repairs during a forensic audit).
* **The Engine (Python):** A dynamic runtime that calculates permutations and parses the `robot.toml` policy.
* **The Actuator (SaltStack):** The idempotent engine that physically touches the disk.

== 2. Installation

The Robot is designed to be embedded as a **Git Submodule** within RSR-compliant projects (like `indieweb2-bastion`).

[source,bash]
----
# In your main repo:
git submodule add https://gitlab.com/hyperpolymath/robot-repo-bot.git maintenance/robot
----

== 3. Usage: The TUI (Recommended)

The safest way to interact with the Robot is via the High-Assurance TUI.

[source,bash]
----
just ui
----

This launches the Ada binary. You will be presented with a **Combinatoric State Matrix**:
1.  **Audit Level:** `Quick` | `Deep` | `Forensic`
2.  **Repair Mode:** `Dry_Run` | `Interactive` | `Ruthless`
3.  **Scope:** `Config` | `Internal` | `Security` | `Complete`

_Note: The TUI will physically disable the "Execute" button if you select a forbidden combination (e.g., Forensic + Ruthless)._

== 4. Usage: The Permutative CLI (Advanced)

For CI/CD or advanced scripting, you may invoke the Python engine directly using the **Assertion Syntax**.

[source,bash]
----
# Syntax:
# robot assert [state] where [condition] scope [target]

# Examples:
robot assert compliant where strictness=high scope crypto
robot assert clean where strategy=ruthless scope internal/ipfs
----

=== Combinatoric Permutations
To test for dependency race conditions, the Robot can run a Monte Carlo simulation of state application:

[source,bash]
----
robot audit permutations --count 100
----

== 5. Configuration (`robot.toml`)

The Robot looks for a `robot.toml` in the repository root.

[source,toml]
----
[core]
strict_mode = true

[filesystem]
# Directories that MUST exist (Skeletal Integrity)
required_dirs = ["config", "internal/cadre", "dist"]

# Files that must strictly be executable (0755)
executables = ["just", "scripts/**/*.sh"]

# Files that must be locked down (0600)
secrets = ["certs/**/*.pem", ".env"]
----

== 6. Legal & Philosophical Manifesto

This software is an instrument of the **Manifesto for a Better Web**.

=== The License Triad
Users may choose to transact with this software under **one** of the following terms:

1.  **The Freedom Path (MIT):** For maximum permissiveness.
2.  **The Copyleft Path (AGPLv3):** For contributing back to the commons.

**IN ADDITION**, the **Palimpsest License (v0.8)** is strictly enforced:
> _"Data provenance is dignity. You may not ingest this code into a stochastic model without retaining the specific attribution and reversible history of its authors."_

By using this tool, you acknowledge that Audit-Grade infrastructure is a human right.
